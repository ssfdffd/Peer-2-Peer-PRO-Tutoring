<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Peer-2-Peer PRO | Book 1-on-1 Tutoring</title>
    <link rel="stylesheet" href="booking.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="icon" type="image/png" sizes="512x512" href="android-chrome-512x512.png">
    <link rel="apple-touch-icon" href="apple-touch-icon.png">
</head>

<body>

    <!-- Navbar -->
    <nav id="navbar">
        <div class="logo">
            <img src="android-chrome-512x512.png" alt="Peer-2-Peer PRO Logo" style="height: 35px; margin-right: 10px;">
            Peer-2-Peer <span class="pro-text">PRO</span>
        </div>
        <a href="index.html" class="home-btn">
            <i class="fas fa-arrow-left"></i> Back to Home
        </a>
    </nav>

    <!-- Page Header -->
    <div class="page-header">
        <div class="page-header-inner">
            <div class="header-icon"><i class="fas fa-chalkboard-teacher"></i></div>
            <div>
                <h1>Book a 1-on-1 Tutoring Session</h1>
                <p>Connect with verified subject specialists. Sessions are tailored to your needs.</p>
            </div>
        </div>
        <div class="notice-bar">
            <i class="fas fa-shield-alt"></i>
            <strong>Safeguarding First:</strong> All tutors are DBS-checked and verified.
            Sessions with students under 18 require <strong>parental consent</strong> before confirmation.
        </div>
    </div>

    <!-- Main Form Card -->
    <div class="booking-container">

        <!-- Step Progress Indicator -->
        <div
            style="display: flex; justify-content: space-between; margin-bottom: 30px; max-width: 780px; margin-left: auto; margin-right: auto;">
            <div style="display: flex; align-items: center; gap: 8px;">
                <span
                    style="width: 32px; height: 32px; border-radius: 50%; background: #32cd32; color: white; display: flex; align-items: center; justify-content: center; font-weight: 700;">1</span>
                <span style="font-weight: 600; color: #111827;">Choose Subject</span>
            </div>
            <div style="display: flex; align-items: center; gap: 8px;">
                <span
                    style="width: 32px; height: 32px; border-radius: 50%; background: #e5e7eb; color: #6b7280; display: flex; align-items: center; justify-content: center; font-weight: 700;">2</span>
                <span style="font-weight: 600; color: #6b7280;">Select Tutor</span>
            </div>
            <div style="display: flex; align-items: center; gap: 8px;">
                <span
                    style="width: 32px; height: 32px; border-radius: 50%; background: #e5e7eb; color: #6b7280; display: flex; align-items: center; justify-content: center; font-weight: 700;">3</span>
                <span style="font-weight: 600; color: #6b7280;">Book Session</span>
            </div>
        </div>

        <form id="bookingForm" novalidate>
            <!-- ‚îÄ‚îÄ SECTION 1: SUBJECT & GRADE ‚îÄ‚îÄ -->
            <div class="form-section" id="step1">
                <div class="section-label">
                    <span class="section-num">1</span>
                    <span>Choose Subject & Grade</span>
                </div>

                <div class="input-row">
                    <div class="field-wrap">
                        <label for="subject">Subject You Need Help With <span class="req">*</span></label>
                        <select id="subject" required>
                            <option value="">-- Select Subject --</option>
                            <option value="Mathematics">üìê Mathematics</option>
                            <option value="Physical Science">üî¨ Physical Science</option>
                            <option value="Life Sciences">üß¨ Life Sciences</option>
                            <option value="English">üìö English</option>
                            <option value="Afrikaans">üáøüá¶ Afrikaans</option>
                            <option value="Accounting">üí∞ Accounting</option>
                            <option value="Economics">üìä Economics</option>
                            <option value="Business Studies">üíº Business Studies</option>
                            <option value="Geography">üåç Geography</option>
                            <option value="History">üìú History</option>
                            <option value="Mathematics Literacy">üìè Mathematical Literacy</option>
                            <option value="Information Technology">üíª Information Technology</option>
                            <option value="Life Orientation">üßò Life Orientation</option>
                        </select>
                    </div>
                    <div class="field-wrap">
                        <label for="studentGrade">Your Grade / Year <span class="req">*</span></label>
                        <select id="studentGrade" required>
                            <option value="">-- Select Grade --</option>
                            <option value="Grade 8">Grade 8</option>
                            <option value="Grade 9">Grade 9</option>
                            <option value="Grade 10">Grade 10</option>
                            <option value="Grade 11">Grade 11</option>
                            <option value="Grade 12">Grade 12</option>
                            <option value="University">University / Tertiary</option>
                            <option value="Adult Learner">Adult Learner</option>
                        </select>
                    </div>
                </div>

                <div style="display: flex; justify-content: flex-end; margin-top: 20px;">
                    <button type="button" id="findTutorsBtn" class="btn-primary"
                        style="background: #32cd32; color: #000033; border: none; padding: 12px 28px; border-radius: 30px; font-weight: 700; display: flex; align-items: center; gap: 8px;">
                        <i class="fas fa-search"></i> Find Available Tutors
                    </button>
                </div>
            </div>

            <!-- ‚îÄ‚îÄ SECTION 2: TUTOR SELECTION (DYNAMIC) ‚îÄ‚îÄ -->
            <div class="form-section hidden" id="step2">
                <div class="section-label">
                    <span class="section-num">2</span>
                    <span>Select Your Tutor</span>
                </div>

                <div id="tutorLoading" style="text-align: center; padding: 30px;">
                    <i class="fas fa-spinner fa-spin" style="color: #32cd32; font-size: 2rem;"></i>
                    <p style="margin-top: 15px; color: #6b7280;">Finding the best tutors for you...</p>
                </div>

                <div id="tutorGrid" style="display: none; flex-direction: column; gap: 16px;"></div>

                <div id="noTutorsMessage"
                    style="display: none; text-align: center; padding: 30px; background: #f7f8fa; border-radius: 12px;">
                    <i class="fas fa-user-graduate" style="font-size: 2.5rem; color: #d1d5db; margin-bottom: 15px;"></i>
                    <h3 style="color: #111827; margin-bottom: 8px;">No tutors available</h3>
                    <p style="color: #6b7280;">We couldn't find tutors for this subject and grade. Try another subject
                        or check back soon.</p>
                </div>
            </div>

            <!-- ‚îÄ‚îÄ SECTION 3: STUDENT DETAILS ‚îÄ‚îÄ -->
            <div class="form-section hidden" id="step3">
                <div class="section-label">
                    <span class="section-num">3</span>
                    <span>Your Information</span>
                </div>

                <div class="input-row">
                    <div class="field-wrap">
                        <label for="studentName">Full Name <span class="req">*</span></label>
                        <input type="text" id="studentName" placeholder="e.g., Lebo Mokoena" required>
                    </div>
                    <div class="field-wrap">
                        <label for="studentEmail">Email Address <span class="req">*</span></label>
                        <input type="email" id="studentEmail" placeholder="student@example.com" required>
                    </div>
                </div>

                <div class="input-row">
                    <div class="field-wrap">
                        <label for="studentAge">Age <span class="req">*</span></label>
                        <input type="number" id="studentAge" placeholder="e.g., 16" min="5" max="99" required>
                    </div>
                    <div class="field-wrap">
                        <label for="studentPhone">WhatsApp / Phone (Optional)</label>
                        <input type="tel" id="studentPhone" placeholder="e.g., 082 123 4567">
                    </div>
                </div>
            </div>

            <!-- ‚îÄ‚îÄ SECTION 4: PARENT/GUARDIAN DETAILS (shows if age < 18) ‚îÄ‚îÄ -->
            <div class="form-section safeguard-section hidden" id="step4">
                <div class="section-label">
                    <span class="section-num">4</span>
                    <span>Parent / Guardian Information</span>
                </div>

                <div class="safeguard-notice">
                    <i class="fas fa-shield-alt"></i>
                    <div>
                        <strong>üîí Safeguarding Requirement</strong> ‚Äî You are under 18, so we need parent/guardian
                        details to verify the session. This is mandatory for your safety.
                    </div>
                </div>

                <div class="input-row">
                    <div class="field-wrap">
                        <label for="parentName">Parent/Guardian Full Name <span class="req">*</span></label>
                        <input type="text" id="parentName" placeholder="e.g., Mrs. Mokoena">
                    </div>
                    <div class="field-wrap">
                        <label for="parentRelation">Relationship <span class="req">*</span></label>
                        <select id="parentRelation">
                            <option value="">-- Select --</option>
                            <option value="Mother">Mother</option>
                            <option value="Father">Father</option>
                            <option value="Guardian">Legal Guardian</option>
                            <option value="Grandparent">Grandparent</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                </div>

                <div class="input-row">
                    <div class="field-wrap">
                        <label for="parentPhone">WhatsApp / Phone <span class="req">*</span></label>
                        <input type="tel" id="parentPhone" placeholder="e.g., 082 123 4567">
                    </div>
                    <div class="field-wrap">
                        <label for="parentEmail">Parent Email <span class="req">*</span></label>
                        <input type="email" id="parentEmail" placeholder="parent@example.com">
                    </div>
                </div>
            </div>

            <!-- ‚îÄ‚îÄ SECTION 5: SESSION DETAILS ‚îÄ‚îÄ -->
            <div class="form-section hidden" id="step5">
                <div class="section-label">
                    <span class="section-num">5</span>
                    <span>Schedule Your Session</span>
                </div>

                <div class="selected-tutor-summary"
                    style="background: #f0f2f5; border-radius: 12px; padding: 16px; margin-bottom: 20px; display: flex; align-items: center; gap: 16px;">
                    <div
                        style="width: 60px; height: 60px; background: #32cd32; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: #000033; font-size: 1.5rem; font-weight: 700;">
                        <span id="tutorInitials">JS</span>
                    </div>
                    <div style="flex: 1;">
                        <h4 style="margin: 0 0 4px 0; color: #111827; font-weight: 700;" id="selectedTutorName">Tutor
                            Name</h4>
                        <p style="margin: 0; color: #6b7280; font-size: 0.9rem;" id="selectedTutorBio">Tutor bio appears
                            here</p>
                    </div>
                    <div style="text-align: right;">
                        <span style="font-weight: 800; font-size: 1.3rem; color: #000033;" id="tutorRate">R250</span>
                        <span style="color: #6b7280; font-size: 0.85rem;">/hour</span>
                    </div>
                </div>

                <div class="input-row">
                    <div class="field-wrap">
                        <label for="sessionDuration">Session Length <span class="req">*</span></label>
                        <select id="sessionDuration" required>
                            <option value="30">30 minutes (R<span id="rate30">125</span>)</option>
                            <option value="60" selected>1 hour (R<span id="rate60">250</span>)</option>
                            <option value="90">1.5 hours (R<span id="rate90">375</span>)</option>
                            <option value="120">2 hours (R<span id="rate120">500</span>)</option>
                        </select>
                    </div>
                    <div class="field-wrap">
                        <label for="sessionDate">Select Date <span class="req">*</span></label>
                        <input type="date" id="sessionDate" required min="">
                    </div>
                </div>

                <div class="input-row">
                    <div class="field-wrap">
                        <label for="sessionTime">Available Times <span class="req">*</span></label>
                        <select id="sessionTime" required>
                            <option value="">-- Select date first --</option>
                        </select>
                        <p style="font-size: 0.8rem; color: #6b7280; margin-top: 6px;">
                            <i class="fas fa-clock"></i> Showing available slots for selected date
                        </p>
                    </div>
                </div>

                <div class="field-wrap full-width">
                    <label for="sessionNotes">What do you need help with? <span
                            class="optional">(optional)</span></label>
                    <textarea id="sessionNotes"
                        placeholder="e.g., I need help with quadratic equations, trigonometry, and exam preparation techniques. I have a test on Friday next week."
                        rows="3"></textarea>
                </div>
            </div>

            <!-- ‚îÄ‚îÄ SECTION 6: CONSENT & CONFIRMATION ‚îÄ‚îÄ -->
            <div class="form-section hidden" id="step6">
                <div class="section-label">
                    <span class="section-num">6</span>
                    <span>Consent & Payment</span>
                </div>

                <div style="background: #f0f2f5; border-radius: 12px; padding: 20px; margin-bottom: 24px;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 12px;">
                        <span style="color: #6b7280;">Session with:</span>
                        <span style="font-weight: 700; color: #111827;" id="confirmTutorName">Tutor Name</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 12px;">
                        <span style="color: #6b7280;">Subject:</span>
                        <span style="font-weight: 700; color: #111827;" id="confirmSubject">Mathematics</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 12px;">
                        <span style="color: #6b7280;">Date & Time:</span>
                        <span style="font-weight: 700; color: #111827;" id="confirmDateTime">Not selected</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 12px;">
                        <span style="color: #6b7280;">Duration:</span>
                        <span style="font-weight: 700; color: #111827;" id="confirmDuration">1 hour</span>
                    </div>
                    <div
                        style="display: flex; justify-content: space-between; padding-top: 12px; border-top: 1px solid #d1d5db; margin-top: 8px;">
                        <span style="font-weight: 700; color: #111827;">Total:</span>
                        <span style="font-weight: 800; font-size: 1.3rem; color: #000033;"
                            id="confirmTotal">R250.00</span>
                    </div>
                </div>

                <div class="consent-list">
                    <label class="consent-item">
                        <input type="checkbox" id="parentApprovalCheck" required>
                        <span>
                            I confirm that <strong>written or verbal parental/guardian approval</strong> has been
                            obtained
                            for this session and the parent listed above is aware and consents.
                        </span>
                    </label>
                    <label class="consent-item">
                        <input type="checkbox" id="contactConsentCheck" required>
                        <span>
                            I consent to Peer-2-Peer PRO contacting the parent/guardian via WhatsApp or email
                            to <strong>verify this booking</strong> before it is confirmed.
                        </span>
                    </label>
                    <label class="consent-item">
                        <input type="checkbox" id="termsCheck" required>
                        <span>
                            I have read and agree to the
                            <a href="terms.html" target="_blank">Terms & Conditions</a>,
                            <a href="privacy.html" target="_blank">Privacy Policy</a>, and
                            <a href="safeguarding.html" target="_blank">Safeguarding Policy</a>.
                        </span>
                    </label>
                </div>

                <div
                    style="margin-top: 24px; padding: 16px; background: #e8fce8; border-radius: 12px; border-left: 4px solid #32cd32;">
                    <div style="display: flex; gap: 12px;">
                        <i class="fas fa-lock" style="color: #32cd32;"></i>
                        <div style="font-size: 0.9rem; color: #374151;">
                            <strong>Secure & Safe:</strong> Your payment is processed securely. Sessions are hosted on
                            Jitsi Meet with password protection. No credit card is required for this demo booking.
                        </div>
                    </div>
                </div>
            </div>

            <div style="display: flex; gap: 16px; margin-top: 24px;">
                <button type="button" id="backBtn" class="btn-secondary"
                    style="display: none; background: white; border: 1px solid #d1d5db; padding: 15px 25px; border-radius: 30px; font-weight: 600;">
                    <i class="fas fa-arrow-left"></i> Back
                </button>
                <button type="submit" id="submitBtn" class="hidden"
                    style="background: #32cd32; color: #000033; border: none; padding: 15px 30px; border-radius: 30px; font-weight: 700; flex: 1; display: flex; align-items: center; justify-content: center; gap: 8px;">
                    <i class="fas fa-calendar-check"></i>
                    Confirm & Request Booking
                </button>
            </div>
        </form>

        <!-- CONFIRMATION AREA (shown after submit) -->
        <div id="confirmationArea" class="hidden">
            <div class="success-card">
                <div class="success-icon"><i class="fas fa-check-circle"></i></div>
                <h3>Booking Request Sent! üìö</h3>
                <p id="detailsText"></p>

                <div class="info-grid">
                    <div class="info-cell">
                        <i class="fas fa-user-tie"></i>
                        <span><strong>Tutor:</strong> <span id="confirmTutorNameSuccess"></span></span>
                    </div>
                    <div class="info-cell">
                        <i class="fas fa-video"></i>
                        <span><strong>Your Private Meeting Room:</strong></span>
                    </div>
                </div>

                <div class="link-box">
                    <span><i class="fas fa-lock"></i> SECURE MEETING LINK (Password Protected)</span>
                    <a id="roomLink" href="#" target="_blank" style="word-break: break-all;"></a>
                    <div
                        style="margin-top: 12px; padding: 12px; background: #f7f8fa; border-radius: 8px; font-size: 0.9rem;">
                        <span style="font-weight: 700;">üîë Meeting Password:</span>
                        <span id="meetingPassword"
                            style="font-family: monospace; background: white; padding: 4px 10px; border-radius: 6px; margin-left: 8px;"></span>
                        <button onclick="copyPassword()"
                            style="margin-left: 10px; background: none; border: none; color: #32cd32; cursor: pointer;">
                            <i class="fas fa-copy"></i>
                        </button>
                    </div>
                </div>

                <div style="display: flex; gap: 12px; margin-top: 24px;">
                    <a href="#" id="joinMeetingBtn" target="_blank"
                        style="flex: 1; background: #000033; color: white; padding: 14px; border-radius: 30px; text-decoration: none; font-weight: 700; display: flex; align-items: center; justify-content: center; gap: 8px;">
                        <i class="fas fa-video"></i> Join Meeting Room
                    </a>
                    <button onclick="window.print()"
                        style="flex: 0.3; background: white; border: 1px solid #d1d5db; padding: 14px; border-radius: 30px; cursor: pointer;">
                        <i class="fas fa-print"></i>
                    </button>
                </div>

                <p class="save-note"><i class="fas fa-bookmark"></i> Save this link and password ‚Äî you'll need them on
                    the day. We've also emailed these details to you and your parent/guardian.</p>
            </div>
        </div>

    </div><!-- /booking-container -->

    <script src="booking.js"></script>
</body>

</html>